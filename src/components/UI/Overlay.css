/* ==============================================
   OVERLAY - RECTIFICATION BLUEPRINT
   Contrast, color theory, and spatial composition fixes
   ============================================== */

.overlay-container {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 1000;
}

.overlay-container>* {
    pointer-events: auto;
}

/* ==============================================
   HOVER EFFECTS
   All hover/pop-out effects are now handled by Framer Motion
   variants in src/utils/animations.ts (popOut, subtle)
   This ensures a single source of truth for all animations.
   ============================================== */

/* ==============================================
   TOP CENTER: Search + Language
   
   Layout Strategy for Centering:
   - top-center-group is centered horizontally.
   - It wraps the Search Bar (320px).
   - Language Button is ABSOLUTELY positioned to the right.
   - This ensures the Search Bar is perfectly centered on screen, 
     ignoring the asymmetric language button width.
   ============================================== */

.top-center-group {
    position: absolute;
    top: 24px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 1010;
    width: auto;
    /* Do NOT use flex gap separation here, we use absolute positioning for language */
    display: flex;
    justify-content: center;
    align-items: center;
    pointer-events: none;
    /* Container is passthrough */
}

.search-container-wrapper {
    /* Let the component define width (320px) */
    width: auto;
    position: relative;
    pointer-events: auto;
    /* Enable Interaction */
}

.lang-container-wrapper {
    position: absolute;
    left: 100%;
    top: 0;
    margin-left: 16px;
    /* Gap */
    /* Ensure it doesn't wrap */
    white-space: nowrap;
    pointer-events: auto;
    /* CRITICAL: Enable Interaction */
}


/* ==============================================
   ICON BUTTON - 48x48 Circle
   ============================================== */
.icon-btn {
    width: 48px;
    height: 48px;
    border-radius: 50%;
    border: none;
    background: var(--surface-translucent);
    backdrop-filter: var(--blur-slight);
    -webkit-backdrop-filter: var(--blur-slight);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
    /* Shadow Resting */
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    color: #4B5563;
    /* Grey text */
    transition: transform 0.2s ease, box-shadow 0.2s ease, color 0.2s ease;
}

.icon-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 16px 48px -12px rgba(0, 0, 0, 0.18);
    /* Shadow Floating */
    color: #111827;
}

.icon-btn:active {
    transform: translateY(0) scale(0.96);
}

/* ==============================================
   LANGUAGE MENU - Contrast Fixed
   ============================================== */
.lang-morph-container {
    background: var(--surface-translucent);
    backdrop-filter: var(--blur-slight);
    -webkit-backdrop-filter: var(--blur-slight);
    box-shadow: 0 16px 48px -12px rgba(0, 0, 0, 0.18);
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    pointer-events: auto;
    /* CRITICAL: Enable Interaction */
}

/* Language List Items */
.lang-options button {
    height: 48px;
    border: none;
    background: transparent;
    border-radius: 9999px;
    font-family: var(--font-family);
    font-size: 15px;
    font-weight: 500;
    color: #1F2937;
    /* Dark Grey Inactive */
    text-align: center;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    justify-content: center;
    transition: background 0.15s ease;
    outline: none !important;
}

.lang-options button:focus,
.lang-options button:focus-visible {
    outline: none !important;
}

.lang-options button:hover {
    background: #F3F4F6;
    /* Light Grey Hover */
}

/* Active State - Blue bg, White text */
.lang-options button.active {
    background: #3B82F6;
    color: #FFFFFF;
}

/* ==============================================
   BOTTOM LEFT: Coordinates & Scale Combined
   ============================================== */
.bottom-left-stack {
    position: absolute;
    bottom: 24px;
    left: 24px;
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    z-index: 1010;
    pointer-events: none;
}

/* Combined Coordinates + Scale Pill */
.coordinates-pill {
    background: var(--surface-translucent);
    backdrop-filter: var(--blur-slight);
    -webkit-backdrop-filter: var(--blur-slight);
    border-radius: 16px;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
    padding: 12px 16px;
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    gap: 8px;
    pointer-events: auto;
}

.coordinates-pill .coords-text {
    font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
    font-size: 14px;
    font-weight: 500;
    color: #111827;
    font-variant-numeric: tabular-nums;
    white-space: nowrap;
}

/* Scale below coords */
.scale-container {
    display: flex;
    align-items: center;
    gap: 8px;
    width: 100%;
}

.scale-bar {
    height: 3px;
    background: #374151;
    border-radius: 1.5px;
    min-width: 40px;
    max-width: 100px;
}

.scale-label {
    font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
    font-size: 11px;
    color: #6B7280;
    font-weight: 500;
}

/* ==============================================
   BOTTOM RIGHT: Floating Button Dock
   ============================================== */
.bottom-right-stack {
    position: absolute;
    bottom: 24px;
    right: 24px;
    display: flex;
    flex-direction: column;
    gap: 8px;
    align-items: center;
    z-index: 1005;
    pointer-events: auto;
}



/* Always visible Hide UI button */
.hide-ui-btn-container {
    position: absolute;
    bottom: 24px;
    right: 24px;
    z-index: 1006;
    pointer-events: auto;
}

/* ==============================================
   BOTTOM CENTER: Dock (Shrink & Contrast Fix)
   ============================================== */
.dock-wrapper {
    position: absolute;
    bottom: 24px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    flex-direction: column;
    align-items: center;
    z-index: 1010;
    pointer-events: auto;
}

.morphing-dock {
    background: var(--surface-translucent);
    backdrop-filter: var(--blur-slight);
    -webkit-backdrop-filter: var(--blur-slight);
    box-shadow: 0 16px 48px -12px rgba(0, 0, 0, 0.18);
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    transform-origin: bottom center;
    /* GPU acceleration for smooth morphing */
    will-change: width, height, border-radius, transform;
    backface-visibility: hidden;
    transform: translateZ(0);
}

.dock-buttons {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 16px;
}

.dock-btn {
    width: 44px;
    height: 44px;
    border-radius: 50%;
    border: none;
    background: transparent;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    color: #4B5563;
    transition: background 0.2s ease, color 0.2s ease;
}

/* Ensure dock icons are visible */
.dock-btn svg {
    width: 22px !important;
    height: 22px !important;
}

/* Blue hover for regular icons - NO background */
.dock-btn:hover {
    color: #3B82F6;
}

/* Icon trace animation - handled by global index.css */
.dock-btn.active {
    background: transparent;
    color: #3B82F6;
    outline: none !important;
}

.dock-btn:focus,
.dock-btn:focus-visible {
    outline: none !important;
}

.dock-divider {
    width: 1px;
    height: 24px;
    background: #E5E7EB;
    margin: 0 4px;
}

/* Placeholder for center button space */
.dock-btn-placeholder {
    width: 44px;
    height: 44px;
}

/* Center button - absolute positioned, animates Menu <-> X */
.dock-center-btn {
    width: 44px;
    height: 44px;
    border-radius: 50%;
    border: none !important;
    background: none !important;
    background-color: transparent !important;
    box-shadow: none !important;
    outline: none !important;
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    color: #4B5563;
    transition: color 0.2s ease;
}

.dock-center-btn:hover {
    color: #3B82F6;
}

.dock-center-btn:focus,
.dock-center-btn:active,
.dock-center-btn:focus-visible {
    border: none !important;
    background: none !important;
    background-color: transparent !important;
    box-shadow: none !important;
    outline: none !important;
    outline-offset: 0 !important;
    color: #4B5563;
    /* Stay gray when focused/active, only hover changes color */
}

/* When showing X (is-close), default is gray, hover turns red */
.dock-center-btn.is-close {
    color: #4B5563;
}

.dock-center-btn.is-close:hover {
    color: #EF4444 !important;
}

.dock-center-btn.is-close:focus,
.dock-center-btn.is-close:active {
    color: #4B5563;
}

/* Panel Header */
.morphed-panel-content {
    padding: 24px;
    padding-bottom: 60px;
    /* Space for absolutely positioned center button */
    width: 100%;
}

.panel-header {
    display: flex;
    justify-content: center;
    align-items: center;
    margin-bottom: 24px;
}

.panel-header span {
    font-size: 14px;
    font-weight: 700;
    color: #111827;
    letter-spacing: 0.5px;
}

.panel-footer {
    display: flex;
    justify-content: center;
    align-items: center;
    margin-top: 16px;
    padding-top: 8px;
}

/* Panel close button - uses dock-btn base styling */
.panel-close-btn {
    background: transparent !important;
    border: none;
    color: #4B5563;
}

.panel-close-btn:hover {
    background: transparent !important;
    color: #EF4444 !important;
}

/* ==============================================
   MEASUREMENT PILL
   ============================================== */
/* ==============================================
   MEASUREMENT PILL
   ============================================== */
.measurement-pill {
    position: absolute;
    bottom: 96px;
    left: 50%;
    /* transform handled by framer-motion in Overlay.tsx to avoid conflict with scale animation */
    background: var(--surface-translucent);
    backdrop-filter: var(--blur-slight);
    -webkit-backdrop-filter: var(--blur-slight);
    border-radius: 9999px;
    box-shadow: 0 16px 48px -12px rgba(0, 0, 0, 0.18);
    /* 
       Symmetric padding of 48px on BOTH sides ensures the text container 
       is perfectly centered in the absolute middle of the pill.
       The close button is then absolutely positioned within that padding space.
    */
    padding: 14px 48px 14px 48px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0;
    /* No gap needed with absolute button */
    font-weight: 600;
    font-size: 15px;
    color: #111827;
    z-index: 1005;
    pointer-events: auto;
}

.measurement-close-btn {
    position: absolute;
    right: 8px;
    /* Fixed distance from right edge */
    top: 50%;
    transform: translateY(-50%);
    background: transparent;
    border: none;
    width: 28px;
    height: 28px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    color: #374151;
    transition: color 0.2s ease;
    padding: 0;
}

.measurement-close-btn:hover {
    color: #EF4444;
}

.measurement-close-btn svg {
    width: 18px !important;
    height: 18px !important;
}

/* ==============================================
   MOBILE
   ============================================== */
@media (max-width: 768px) {
    .top-center-group {
        top: 16px;
        left: 50%;
        transform: translateX(-50%);
        width: auto;
        flex-direction: row;
        gap: 8px;
        justify-content: center;
    }

    .search-container-wrapper,
    .lang-container-wrapper {
        width: auto;
        margin: 0;
        flex-shrink: 0;
    }

    .coordinates-pill {
        padding: 10px 16px;
        font-size: 13px;
    }

    .bottom-left-stack,
    .bottom-right-stack {
        bottom: 100px;
    }
}